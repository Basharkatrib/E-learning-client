## ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø¯ÙØ¹ ÙˆÙˆØ§Ø¬Ù‡Ø§Øª API

### Ø§Ù„Ù‡Ø¯Ù
Ø´Ø±Ø­ ØªØ¯ÙÙ‚ Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„Ù…Ù†ØµÙ‘Ø©ØŒ Ù…Ø§ Ù‡ÙŠ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ù€ API Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©ØŒ ÙƒÙŠÙ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©ØŒ ÙˆÙ„Ù…Ø§Ø°Ø§ ØªÙ… Ø§ØªØ®Ø§Ø° Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª.

---

### Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ ØªØ¯ÙÙ‚ Ø§Ù„Ø¯ÙØ¹
- **Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©**
  - Ø¹Ù†Ø¯ ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¯ÙˆØ±Ø©ØŒ Ù†ØªØ­Ù‚Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø©.
  - Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„Ø§Ù‹ Ù†Ø¹Ø±Ø¶ ÙÙˆØ±Ø§Ù‹ Ø£Ø²Ø±Ø§Ø± Â«Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª / Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„Â».
  - Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Â«Ø³Ø¬Ù‘Ù„ Ù…Ø¬Ø§Ù†Ø§Ù‹Â» ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø®Ø·ÙˆØ§Øª Ø¯ÙØ¹.

- **Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©**
  - Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø¯ÙˆØ±Ø© Ù†ÙØ­ÙˆÙ‘ÙÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ØµÙØ­Ø© Checkout.
  - Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Â«Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹Â» ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Â«Ø·Ù„Ø¨ Ø¯ÙØ¹Â» ÙŠØ¹Ø±Ø¶ QR Ù„Ù„Ù…Ø¯Ø±Ù‘Ø³ Ø­Ø³Ø¨ Ø§Ù„ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© (Syriatel Ø£Ùˆ MTN).
  - Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹ ØªÙƒÙˆÙ† Pending Ø­ØªÙ‰ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ù…Ø¯Ø±Ù‘Ø³ Ø§Ù„Ø·Ù„Ø¨ ÙŠØ¯ÙˆÙŠÙ‘Ø§Ù‹ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…ØŒ Ø«Ù… ØªØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ Paid/Accepted ÙˆÙŠØµØ¨Ø­ Ø¨Ø¥Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª.

Ù„Ù…Ø§Ø°Ø§ Ù‡Ø°Ø§ Ø§Ù„ØªØ¯ÙÙ‚ØŸ
- Ù„Ø£Ù† Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¯ÙØ¹ ÙŠØªÙ… ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø­ÙˆØ§Ù„Ø©ØŒ ÙØªÙ… ÙØµÙ„ Â«Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨Â» Ø¹Ù† Â«Ø§Ù„ØªÙØ¹ÙŠÙ„Â»ØŒ Ù…Ø¹ Ù†Ù‚Ø·Ø© ØªØ­Ù‚Ù‚ Ù„Ø§Ø­Ù‚Ø© Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹.

---

### ÙˆØ§Ø¬Ù‡Ø§Øª API Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Backend)



2) Ø§Ù„ØªØ³Ø¬ÙŠÙ„/Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø¯ÙØ¹
- Method: POST
- Path: `/api/v1/courses/{course}/enroll`
- Auth: Bearer token
- Ø§Ù„Ø³Ù„ÙˆÙƒ:
  - Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ø¬Ø§Ù†ÙŠØ©: ØªÙØ¹ÙŠÙ„ ÙÙˆØ±ÙŠ ÙˆØ¥Ø±Ø¬Ø§Ø¹ Ù†Ø¬Ø§Ø­.
  - Ø¥Ù† ÙƒØ§Ù†Øª Ù…Ø¯ÙÙˆØ¹Ø©: ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Â«Ø·Ù„Ø¨ Ø¯ÙØ¹Â»ØŒ ÙˆÙ‚Ø¯ ØªØ¹ÙˆØ¯ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø¨Ø­Ø§Ù„Ø© 200 Ø£Ùˆ 402 Ù…Ø¹ ØªÙØ§ØµÙŠÙ„ QR.

Ù…Ø«Ø§Ù„ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø­Ø§Ù„Ø© Â«Payment RequiredÂ»:
```json
{
  "status": "payment_required",
  "payment_details": {
    "teacherQRCodes": {
      "syriatel": "https://.../qr-syr.png",
      "mtn": "https://.../qr-mtn.png"
    },
    "amount": 25000,
    "currency": "SYP"
  }
}
```

3) Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹ (Ù…Ø¯ÙÙˆØ¹ ÙÙ‚Ø·)
- Method: GET
- Path: `/api/v1/courses/{course}/payment-status`
- Auth: Bearer token
- ÙŠØ­Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
```json
{
  "paymentStatus": "pending",    // pending | paid | rejected
  "enrollmentStatus": "waiting"   // waiting | accepted | rejected
}
```

4) ÙØ­Øµ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (Ù…Ø®ØµÙ‘Øµ Ù„Ù„Ù…Ø¬Ø§Ù†ÙŠ)
- Method: POST
- Path: `/api/v1/enrollment/check`
- Auth: Bearer token
- Body:
```json
{ "userId": 5, "courseId": 12 }
```



// Pusher code

Ø§Ø·Ù„Ø¨ÙŠ Ù…Ù† Chat gpt ÙŠØ¹Ù…Ù„Ùƒ ØªØ­ÙˆÙŠÙ„ Ù‡Ø§Ø¯ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‰ ÙƒÙˆØ¯ ÙÙ„Ø§ØªØ± ÙˆØ§Ø³Ø£Ù„ÙŠÙ‡ Ø´Ùˆ Ø§Ù„Ù…ÙƒØªØ¨Ø© ÙŠÙ„ÙŠ Ù„Ø§Ø²Ù… ØªÙ†Ø²Ù„ÙŠØ§ Ø¹Ù†Ø¯Ùƒ Ø¨Ø§Ù„ÙØ±ÙˆÙ†Øª

Ø§Ù„ Api key

VITE_PUSHER_API_KEY=3bf9a9c0257b12e21397

useEffect(() => {
    if (!currentUser?.id) return;
    Pusher.logToConsole = true;

    const pusher = new Pusher(import.meta.env.VITE_PUSHER_API_KEY, {
      cluster: 'eu',
    });
    const channel = pusher.subscribe('user-notifications-' + currentUser.id);
    channel.bind('enrollment-accepted', function (data) {
      // Add notification to Redux store
      dispatch(addNotification({
        id: Date.now(), // Use timestamp as unique ID
        message: data.data.message || 'New notification received!',
        read: false,
        timestamp: new Date().toISOString()
      }));

      // Show toast notification
      toast(data.data.message || 'New notification received!', {
        duration: 4000,
        position: 'top-right',
        style: {
          background: theme === 'dark' ? '#1F2937' : '#fff',
          color: theme === 'dark' ? '#fff' : '#000',
          border: '1px solid #6D28D9',
        },
        icon: 'ðŸ””',
      });
    });

    // Listen for role update events on the same channel
    channel.bind('role-updated', (payload) => {
      const message =
        payload?.data?.message ??
        payload?.message ??
        payload?.data?.data?.message ??
        'ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙ„Ø§Ø­ÙŠØ§Øª Ø­Ø³Ø§Ø¨Ùƒ.';

      dispatch(addNotification({
        id: Date.now(),
        message,
        read: false,
        timestamp: new Date().toISOString(),
      }));

      toast(message, {
        duration: 4000,
        position: 'top-right',
        style: {
          background: theme === 'dark' ? '#1F2937' : '#fff',
          color: theme === 'dark' ? '#fff' : '#000',
          border: '1px solid #6D28D9',
        },
        icon: 'ðŸ”„',
      });
    });

    return () => {
      channel.unbind('enrollment-accepted');
      channel.unbind('role-updated');
      channel.unsubscribe();
      pusher.disconnect();
    };
  }, [currentUser?.id, theme, dispatch]);


